---
title: "字符编码发展梳理"
date: 2022-03-02T00:38:28+08:00
tags: ["计算机基础"]
---

从 Golang 中的字符串出发，我们知道 Go 语言中 `string` 的实现是基于 `utf-8` 编码的。遍历 `string` 一般有以下两种写法：

1. 通过索引下标，去遍历字符串中每一个字节

2. 通过 for range `rune` 类型遍历字符串中每一个 `utf-8 `字符

```Golang
// 索引下标的方式    
for i := 0; i < len(str); i ++ {
        fmt.Printf("索引: %d , 十进制: %d, ASCII字符 %q \n", i, str[i], str[i])
    }
// for range, rune 的方式
    for i, ch := range str {
        fmt.Printf("索引:%d 十进制: %d, 十六进制: %X,二进制:%b, utf 码点: %U \n",i, ch, ch, ch, ch)
    }
```

- 这两者区别在那？

- 为什么 Golang 要支持这两种方式，或者说为什么 Golang 字符串的实现要基于 `utf-8` 编码

## 从 ASCII 字符编码到 UTF-8

### 起点: ASCII 码

首先我们要知道在计算机的世界中，一切数据都是以字节流的形式存在。例如下图，一个字节（8 个 bit）可以表示从 0 - 255 之间的整数。 

<img title="" src="http://ganghuan.oss-cn-shenzhen.aliyuncs.com/img/image-20220221174739815-2022-02-21.png" alt="image-20220221174739815" data-align="center">

但是我如果想表示一个字符呢？

**字符定义**：

> 在[电脑](https://zh.wikipedia.org/wiki/電腦)和[电信](https://zh.wikipedia.org/wiki/電信)领域中，**字符**（Character）是一个[信息](https://zh.wikipedia.org/wiki/資訊)单位。对使用[字母系统](https://zh.wikipedia.org/wiki/字母系統)或[音节文字](https://zh.wikipedia.org/wiki/音節文字)等[自然语言](https://zh.wikipedia.org/wiki/自然語言)，它大约对应为一个[音位](https://zh.wikipedia.org/wiki/音位)、类音位的单位或符号。简单来讲就是一个汉字、假名、韩文字……，或是一个英文、其他西方语言的字母。字符的例子有：[字母](https://zh.wikipedia.org/wiki/字母)、[数字系统](https://zh.wikipedia.org/wiki/數字系統)或[标点符号](https://zh.wikipedia.org/wiki/標點符號)。

此时需要一个字符与整数之间的**映射关系**。例如，用整数 97 -> a。你传入一个整数，并且指明这个整数是字符类型，那么计算机就给你显示成字符

这时候最通用的 `ASCII` (**A**merican **S**tandard **C**ode for **I**nformation **I**nterchange，**美国信息交换标准代码**) 在·1963 年由美国国家标准协会提出。

<img src="https://ganghuan.oss-cn-shenzhen.aliyuncs.com/img/5ekqAK-2022-03-03.png" title="" alt="5ekqAK-2022-03-03" data-align="center">

最初版 ASCII 编码使用一个字节中的 7 个 bit 位 （整数 0-127）定义了整数到  128 个字符的映射关系。最初的 ASCII 定义的 128 个字符与其编码方式如下图所示。

![](https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/USASCII_code_chart.png/1024px-USASCII_code_chart.png)

#### 编码范围

十进制: 0-127

字节形式：

<img title="" src="file:///Users/bytedance/Library/Application%20Support/marktext/images/2022-03-03-14-52-18-image.png" alt="" data-align="center">

#### ASCII 意义

包含了使用最广泛的控制字符、数字符号、英文字母、英文符号，作为鼻祖，成为计算机编码系统的基础，以后出现的各种字符编码基本都要兼容它

#### 缺点

只能表示一些基本英文字母、阿拉伯数字和英式标点符号。所以基本只适用于英语语系的国家

### 字符集与字符编码的区别

在这里先补充下字符集与字符编码定义的区别，再继续介绍

**字符集**：字符的集合，并为字符分配了唯一的编号（码点），例如可以把所有英文字符定义为一种集合，也可以把所有中文字符定义为一种字符集。

**字符编码**：字符集映射成字节流的方式，可以直接把码点直接存储在计算机中，也可以做一次转换。

在最早期，一种字符集只有一种编码方式，直接使用它们码点数字存储在计算机。如 ASCII 码，它是一种字符集也是一种字符编码，所以叫法比较乱。

直到 Unicode 出现，这两者之间的区别才比较清晰。如 Unicode 是一种字符集，每一个字符都会预先分配一个编号。而 utf-8、utf-16、utf-32 都是其中的一种编码方式

![](https://www.icode9.com/i/l/?n=20&i=blog/11824/202102/11824-20210222210932851-351737889.png)

### 野蛮发展时期

显然 ASCII 字符集包括的128 个字符不能满足广大人民群众的需求，于是字符集的扩充陷入到一阵野蛮发展的时期

#### EASCII

ASCII 出来后，最先感到不适应的是欧洲地区，欧洲一些地区也比较发达，但所使用的语言不是英语，其语言的一些字符在电脑中无法表示。

于是扩展 ASCII (EASCII) 出现了，由于 ASCII 码只使用了一个字节中的 7 个 bit，扩展 ASCII 就是利用了剩下的最高 bit (128 - 255) 扩展出了 128 个字符使用。EASCII 拓展的字符在字节里最高位都是 1.

<img src="file:///Users/bytedance/Library/Application%20Support/marktext/images/2022-03-03-14-57-03-image.png" title="" alt="" data-align="center">

这扩展的 128 字符如下图，如要包括表格符号、计算符号、希腊字母和特殊的拉丁符号

![Informatika na Gymnáziu a Jazykové škole s právem státní jazykové zkoušky Zlín](https://www.gjszlin.cz/ivt/esf/ostatni-sin/images/04_cp852.png)

#### GB2313、BIG5、GBK 与 GB18030

时代在发展，当计算机渐渐在东亚流行后，计算机无法表示当地字符，东亚人民感受到极大的不便

##### GB 2313

GB2313 是中国国家标准简体中文字符集，由中国国家标准总局于1980年发布，支持的字符

- 6763 个常用汉字

- 682 个其它字符

**编码方式**

- 兼容 ASCII 字符

- 新增汉字和其它字符使用**两个字节**编码

**如何在字节流中区分 ASCII 字符与 GB2312 支持的字符**

- 最高位 0 的字节编码成 ASCII 字符

- 最高位 1 的字节 + 后续的一个字节编码成 GB 2312 支持的字符

理论中的编码范围如下，实际上总共需要表示 7445 多个字符，只使用了一部分空间。

![](/Users/bytedance/Library/Application%20Support/marktext/images/2022-03-03-15-28-42-image.png)

##### BIG5

由于 GB2312 不包括繁体字符，台湾同胞们不乐意了

**BIG5：** BIG-5 码是通行于台湾、香港地区的一个繁体字编码方案。使用2个字节表示，表示13053 个汉字

##### GBK

中国也有使用繁体字的需求，于是 GBK 增加了对繁体字的支持，在 1995 年被提出。兼容 GB2312，还是使用 2 个字节表示，可表示 21886 个字符

##### GB18030

随着计算机逐渐深入人民生活，发现有相当部分的人的名字包括生僻字，无法在计算机中表示。

GB18030 在 2005 年有中国国家标准化管理委员会提出。

- 支持中国国内少数民族的文字
- 汉字收录范围包含繁体汉字以及日韩汉字

**编码方式**

- 1, 2, 4 个字节的变长编码

- 一个字节兼容 ASCII 编码

- 两个字节兼容 GBK 编码

- 四个字节支持新增的字符

### 终点: Unicode 字符集

上述的发展只是描述中国这一块区域的字符集的发展，而世界上有这么多国家，这么多文化。字符集与字符编码的爆炸使得开发人员痛苦，并且日常使用中使用者经常选择错误的编码方式打开文本导致乱码

**Unicode** 全称 Unicode Character Set，是国际组织制定的可以容纳**世界上所有文字和符号**字的集合

#### UTF-32



#### UTF-16



#### UTF-8
