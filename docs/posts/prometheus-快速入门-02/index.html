<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <title>Prometheus 快速入门-02 | 小贺的博客</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="数据模型 🔗Prometheus 底层将所有数据存储为时间序列: 即以相同 metric 和 label 维度聚合的带时间戳的流。
时序格式 🔗下面格式表示一个 metric 和 label 的时序数据集合
&lt;metric name&gt;{&lt;label name&gt;=&lt;label value&gt;, ...} 例如，一个时间序列的度量名称 api_http_requests_total 和 label 方法=&ldquo;POST&rdquo; 和handler=&quot;/messages&quot;可以写成这样:
api_http_requests_total{method=&#34;POST&#34;, handler=&#34;/messages&#34;} 采样 🔗Prometheus 通过 pull 收到各个 metric 的实际数据，样本形成实际的时间序列数据，每个样本包括:
  float64值
  一个毫秒精度时间戳
  小结 🔗 Prometheus 以 metric 和 label 的维度聚合时序数据 Prometheus 以 pull 方式，收集各个监控目标上 metric 的值与时间戳  Metric 类型 🔗Prometheus Metric 有四种类型：Counter，Gauge，Histogram，Summary
Counter 🔗  特性：只增不减
  适用：服务请求数、已完成任务数、错误出现次数等
  示例：http 请求数">
<meta name="generator" content="Hugo 0.89.2" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/xiaohe-blog/css/style.css">



<link rel="shortcut icon" href="/xiaohe-blog/images/favicon.ico" type="image/x-icon" />

 
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-FY1WNXTY3L', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







  </head>

  <body>
    <nav class="navigation">
	
		<a href="/xiaohe-blog/"> <span class="arrow">←</span>首页</a>
	
	<a href="/xiaohe-blog/posts">归档</a>
	<a href="/xiaohe-blog/tags">标签</a>
	<a href="/xiaohe-blog/about">关于</a>

	
		<a href="/xiaohe-blog/%e7%ae%97%e6%b3%95">算法</a>
	
		<a href="/xiaohe-blog/%e6%9d%82%e8%b0%88">杂谈</a>
	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Prometheus 快速入门-02</h1>

    <div class="tip">
      <div>2021年12月8日</div>
        <span class="split">
          ·
        </span>
        <span>
          730字
        </span>
        <span class="split">
          ·
        </span>
        <span>
          4分钟 读完
        </span>
        <div class="views">
          <span class="views">
              <img src="https://visitor-badge.glitch.me/badge?page_id=https%3a%2f%2fhe2121.github.io%2fxiaohe-blog%2fposts%2fprometheus-%25E5%25BF%25AB%25E9%2580%259F%25E5%2585%25A5%25E9%2597%25A8-02%2f" alt="Views"/>
          </span>
      </div>
    </div>

    
    


    <div class="content">
      <h2 id="数据模型">数据模型 <a href="#%e6%95%b0%e6%8d%ae%e6%a8%a1%e5%9e%8b" class="anchor">🔗</a></h2><p>Prometheus 底层将所有数据存储为时间序列:  即以相同 metric 和 label 维度聚合的带时间戳的流。</p>
<h3 id="时序格式">时序格式 <a href="#%e6%97%b6%e5%ba%8f%e6%a0%bc%e5%bc%8f" class="anchor">🔗</a></h3><p>下面格式表示一个 metric 和 label 的时序数据集合</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&lt;metric name&gt;<span style="color:#f92672">{</span>&lt;label name&gt;<span style="color:#f92672">=</span>&lt;label value&gt;, ...<span style="color:#f92672">}</span>
</code></pre></div><p>例如，一个时间序列的度量名称 api_http_requests_total 和 label 方法=&ldquo;POST&rdquo; 和handler=&quot;/messages&quot;可以写成这样:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">api_http_requests_total<span style="color:#f92672">{</span>method<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;POST&#34;</span>, handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/messages&#34;</span><span style="color:#f92672">}</span>
</code></pre></div><h3 id="采样">采样 <a href="#%e9%87%87%e6%a0%b7" class="anchor">🔗</a></h3><p>Prometheus 通过 pull 收到各个 metric 的实际数据，样本形成实际的时间序列数据，每个样本包括:</p>
<ul>
<li>
<p>float64值</p>
</li>
<li>
<p>一个毫秒精度时间戳</p>
</li>
</ul>
<h3 id="小结">小结 <a href="#%e5%b0%8f%e7%bb%93" class="anchor">🔗</a></h3><ul>
<li>Prometheus 以 metric 和 label 的维度聚合时序数据</li>
<li>Prometheus 以 pull 方式，收集各个监控目标上 metric 的值与时间戳</li>
</ul>
<h2 id="metric-类型">Metric 类型 <a href="#metric-%e7%b1%bb%e5%9e%8b" class="anchor">🔗</a></h2><p>Prometheus Metric 有四种类型：Counter，Gauge，Histogram，Summary</p>
<h3 id="counter">Counter <a href="#counter" class="anchor">🔗</a></h3><ul>
<li>
<p><strong>特性</strong>：只增不减</p>
</li>
<li>
<p><strong>适用</strong>：服务请求数、已完成任务数、错误出现次数等</p>
</li>
<li>
<p><strong>示例</strong>：http 请求数</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># TYPE prometheus_http_requests_total counter</span>
prometheus_http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span>,handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/-/ready&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span>,handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/api/v1/label/:name/values&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">43</span>
prometheus_http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span>,handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/api/v1/labels&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">35</span>
</code></pre></div><ul>
<li><strong>Go SDK</strong>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-GO" data-lang="GO"><span style="color:#75715e">// counter + 1
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Inc</span>()
<span style="color:#75715e">// counter + 任意值，这个值小于 0， 则 panic
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">float64</span>)
</code></pre></div><h3 id="gauge">Gauge <a href="#gauge" class="anchor">🔗</a></h3><ul>
<li>
<p><strong>特性</strong>：数据可以任意变化，可增可减</p>
</li>
<li>
<p><strong>适用</strong>：温度、内存/磁盘使用率等</p>
</li>
<li>
<p><strong>示例</strong>：go 当前协程数</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># TYPE go_goroutines gauge</span>
go_goroutines <span style="color:#ae81ff">35</span>
</code></pre></div><ul>
<li><strong>Go SDK</strong>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 设置任意值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Set</span>(<span style="color:#66d9ef">float64</span>)
<span style="color:#75715e">// 加一
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Inc</span>()
<span style="color:#75715e">// 减1
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Dec</span>()
<span style="color:#75715e">// 加任意值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">float64</span>)
<span style="color:#75715e">// 减任意值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Sub</span>(<span style="color:#66d9ef">float64</span>)
<span style="color:#75715e">// 设置成当前时间的 unix 秒值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">SetToCurrentTime</span>()
</code></pre></div><h3 id="histogram直方图">Histogram（直方图） <a href="#histogram%e7%9b%b4%e6%96%b9%e5%9b%be" class="anchor">🔗</a></h3><ul>
<li><strong>特性</strong>：一段时间范围内对数据进行采样，对其指定区间以及总数进行统计</li>
<li><strong>适用</strong>：页面的响应时间分布、resp 的 body 大小分布等&hellip;</li>
<li><strong>示例</strong>：http 请求延时</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># HELP prometheus_http_request_duration_seconds Histogram of latencies for HTTP requests.</span>
<span style="color:#75715e"># TYPE prometheus_http_request_duration_seconds histogram</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.1&#34;</span><span style="color:#f92672">}</span> 6	// 延时小于 0.1 s 的请求数 <span style="color:#ae81ff">6</span> 个
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.2&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span> // 延时小于 0.2 s 的请求数 <span style="color:#ae81ff">6</span> 个
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.4&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;8&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;20&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;60&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;120&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">6</span>
prometheus_http_request_duration_seconds_bucket<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>,le<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;+Inf&#34;</span><span style="color:#f92672">}</span> 6	// 这个实际上等于总请求数
prometheus_http_request_duration_seconds_sum<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">}</span> 0.00016767900000000003	// 上述样本求和 sum
prometheus_http_request_duration_seconds_count<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">}</span> 6							// 这次采样总请求数
</code></pre></div><ul>
<li><strong>Go SDK</strong> ：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 观测这个值落在了哪个 buckte 中
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Observe</span>(<span style="color:#66d9ef">float64</span>)
</code></pre></div><h3 id="summary">Summary <a href="#summary" class="anchor">🔗</a></h3><ul>
<li><strong>特性</strong>：与 Histogram 类似</li>
<li><strong>适用</strong>：与 Histogram 类似</li>
<li><strong>示例</strong>：垃圾回收停顿时间</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span>
<span style="color:#75715e"># TYPE go_gc_duration_seconds summary</span>
go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">}</span> 4.2354e-05
go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">}</span> 9.222e-05
go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.5&#34;</span><span style="color:#f92672">}</span> 0.000133648
go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.75&#34;</span><span style="color:#f92672">}</span> 0.000193116
go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">}</span> 0.00906632
go_gc_duration_seconds_sum 0.064656275
go_gc_duration_seconds_count <span style="color:#ae81ff">295</span>
</code></pre></div><ul>
<li><strong>Go SDK</strong>：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 观测值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">Observe</span>(<span style="color:#66d9ef">float64</span>)
</code></pre></div><h5 id="summary-vs-histogram">Summary VS Histogram <a href="#summary-vs-histogram" class="anchor">🔗</a></h5><p><strong>相同</strong></p>
<ul>
<li>都用来表示一段时间内数据采样结果</li>
<li>适用于查看值分布的场景</li>
</ul>
<p><strong>不同点</strong></p>
<ul>
<li>Histogram：客户端在收集数据时，不存储具体的值，还是多个 bucket counter，性能相对 Counter，Gauge 无差别。但可以在服务端计算出分位数据</li>
<li>Summary： 客户端把一段时间内（默认是10分钟）的数据存储下来，再去计算分位数，性能相对低一些</li>
</ul>
<p><strong>如何选择</strong></p>
<ul>
<li>需要聚合，选 Histogram。Summary 无法聚合，因为一般要监控多台机器，而 Summary 在客户端计算分位数据</li>
<li>分位数据要精确，选 Summary</li>
</ul>
<h2 id="pormql-使用">PormQL 使用 <a href="#pormql-%e4%bd%bf%e7%94%a8" class="anchor">🔗</a></h2><h3 id="pormql-查询返回数据类型">PormQL 查询返回数据类型 <a href="#pormql-%e6%9f%a5%e8%af%a2%e8%bf%94%e5%9b%9e%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b" class="anchor">🔗</a></h3><ol>
<li><strong>瞬时向量（Instant vector）</strong>: 包含一组时序数据，默认返回<strong>最新时间点的值</strong></li>
</ol>
<p>查询语句，格式与上述提到的<a href="#%e6%97%b6%e5%ba%8f%e6%a0%bc%e5%bc%8f">时序格式</a>一致，例如</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">// 例子1 查询 http 接口请求数
http_requests_total
// 例子2 查询 http 接口请求数，限定 hanlder
http_requests_total<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/api/comments&#34;</span><span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>返回结果</li>
</ul>
<p><p class="markdown-image">
  <img src="http://ganghuan.oss-cn-shenzhen.aliyuncs.com/img/image-20211208170850461-2021-12-08.png" alt="image-20211208170850461"  />
</p></p>
<ol start="2">
<li><strong>范围向量（Range vector）</strong>: 一组时序数据，每个时序有多个值（限定在一段时间内，不同时间点的值）</li>
</ol>
<ul>
<li>查询语句，</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">// 例子1 查询 http <span style="color:#ae81ff">5</span> 分钟内 上报数据
http_requests_total<span style="color:#f92672">[</span>5m<span style="color:#f92672">]</span>
// 例子2 查询 http 指定 handler <span style="color:#ae81ff">5</span> 分钟内 上报的数据
http_requests_total<span style="color:#f92672">{</span>handler<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/api/comments&#34;</span><span style="color:#f92672">}[</span>5m<span style="color:#f92672">]</span>
</code></pre></div><ul>
<li>
<p>返回结果</p>
<p><p class="markdown-image">
  <img src="http://ganghuan.oss-cn-shenzhen.aliyuncs.com/img/image-20211208171741338-2021-12-08.png" alt="image-20211208171741338"  />
</p></p>
</li>
</ul>
<ol start="3">
<li><strong>标量</strong></li>
</ol>
<p>单纯的数字：2，2.0</p>
<h3 id="查询语句">查询语句 <a href="#%e6%9f%a5%e8%af%a2%e8%af%ad%e5%8f%a5" class="anchor">🔗</a></h3><ol>
<li><code>metric_name{label_name=lable_value}</code>查询出瞬时向量，例如</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span> // 表示查询 metric 为 http_requests_total，label code 为 <span style="color:#e6db74">&#34;200&#34;</span> 的数据
</code></pre></div><ol start="2">
<li>
<p>瞬时查询语句后加上<code>[time]</code>，例如<code>metric_name{label_name=lable_value}[5m]</code>表示限定 5 分钟内的数据，返回的是范围向量</p>
</li>
<li>
<p>查询条件支持不等于<code>!=</code>，正则 <code>=~</code> <code>!~</code>, 例如</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http_requests_total<span style="color:#f92672">{</span>code!<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span>  // 表示查询 code 不为 <span style="color:#e6db74">&#34;200&#34;</span> 的数据
http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span>～<span style="color:#e6db74">&#34;2..&#34;</span><span style="color:#f92672">}</span> // 表示查询 code 为 <span style="color:#e6db74">&#34;2xx&#34;</span> 的数据
http_requests_total<span style="color:#f92672">{</span>code!～<span style="color:#e6db74">&#34;2..&#34;</span><span style="color:#f92672">}</span> // 表示查询 code 不为 <span style="color:#e6db74">&#34;2xx&#34;</span> 的数据
</code></pre></div><ul>
<li>瞬时向量结果支持<a href="https://prometheus.io/docs/prometheus/latest/querying/operators/" target="_blank" rel="noopener">运算</a>，<code>+，-，*，/，%，^，==，!=，&gt;，&lt;，&gt;=，&lt;=，and，or，unless，sum，min，max，avg，stddev，stdvar，count，count_values，bottomk，topk，quantile</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span> * <span style="color:#ae81ff">2</span> // 把里面的值 * <span style="color:#ae81ff">2</span>
http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span> &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> // 只要值 &gt; <span style="color:#ae81ff">2</span> 的数据
http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span> &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> or http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> // 只要值 &gt; <span style="color:#ae81ff">2</span> 的数据和值为 <span style="color:#ae81ff">0</span> 的
sum<span style="color:#f92672">(</span>http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">})</span> // 各个时序数据里的值求和
topk<span style="color:#f92672">(</span>5, http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">})</span> // 只要值在前 <span style="color:#ae81ff">5</span> 的时序数据
</code></pre></div><ul>
<li><a href="https://prometheus.io/docs/prometheus/latest/querying/functions/" target="_blank" rel="noopener">内置函数 </a> 如 <code>abs,floor, rate</code>, 不同函数有着不同的操作对象，例如 <code>rate</code> 针对与范围向量，瞬时向量没有增长率</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">floor<span style="color:#f92672">(</span>avg<span style="color:#f92672">(</span>http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}))</span>	// 向下取整
ceil<span style="color:#f92672">(</span>avg<span style="color:#f92672">(</span>http_requests_total<span style="color:#f92672">{</span>code<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;200&#34;</span><span style="color:#f92672">}))</span>	// 向上取整
rate<span style="color:#f92672">(</span>http_requests_total<span style="color:#f92672">[</span>5m<span style="color:#f92672">])</span>								// 求 5m 增长率
</code></pre></div><h2 id="go-client-实现自定义-exporter">Go Client 实现自定义 exporter <a href="#go-client-%e5%ae%9e%e7%8e%b0%e8%87%aa%e5%ae%9a%e4%b9%89-exporter" class="anchor">🔗</a></h2><p>在上一篇文章中，提到了 Prometheus 提供了许多插件式的 <a href="https://prometheus.io/docs/instrumenting/exporters/" target="_blank" rel="noopener">Exporter</a>, 可以通过安装这些 exporter 来监控各种指标，如机器、容器、中间件、MySQL &hellip;</p>
<p>但是如果我们想监控应用程序呢，如 http，rpc 接口的 QPS、接口时延、错误率。这时候我们可以利用 Prometheus Client SDK 自定义监控</p>
<h3 id="示例">示例 <a href="#%e7%a4%ba%e4%be%8b" class="anchor">🔗</a></h3><ul>
<li>如下面代码所示，有一个 web 的 demo，分别有两个接口 <code>/api1</code> 与 <code>api2</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
  <span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/api1&#34;</span>, <span style="color:#a6e22e">api1</span>)
	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/api2&#34;</span>, <span style="color:#a6e22e">api2</span>)

	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:1234&#34;</span>, <span style="color:#66d9ef">nil</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		panic(<span style="color:#a6e22e">err</span>)
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">api1</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;hello api1&#34;</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">api2</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;hello api2&#34;</span>)
}

</code></pre></div><ul>
<li>如何利用 prometheus 监控这两个接口请求量与接口时延呢</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go get github.com/prometheus/client_golang/prometheus
</code></pre></div><ol>
<li>向外暴露 exporter 地址，下述例子使用默认的 exporter 提供了一些 go 程序的基本监控，如 go 协程数，垃圾回收时间..</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/metrics&#34;</span>, <span style="color:#a6e22e">promhttp</span>.<span style="color:#a6e22e">Handler</span>())
<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>() {
	<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:1235&#34;</span>, <span style="color:#66d9ef">nil</span>)
}()
</code></pre></div><p>exporter 上报数据示例如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># HELP go_goroutines Number of goroutines that currently exist.</span>
<span style="color:#75715e"># TYPE go_goroutines gauge</span>
go_goroutines <span style="color:#ae81ff">9</span>
<span style="color:#75715e"># HELP go_info Information about the Go environment.</span>
<span style="color:#75715e"># TYPE go_info gauge</span>
go_info<span style="color:#f92672">{</span>version<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;go1.17.2&#34;</span><span style="color:#f92672">}</span> <span style="color:#ae81ff">1</span>
...
</code></pre></div><ol start="2">
<li>
<p>注册自定义接口 Counter</p>
<ul>
<li>
<p><code>NewCounter</code>:一个 Counter</p>
</li>
<li>
<p><code>NewCounterVec</code>: 一组 Counter，按里面的 label 值分组</p>
</li>
</ul>
</li>
</ol>
<p>使用示例如下（完整例子在这节最后）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 声明一个 Counter
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">apiCounterVec</span> = <span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">NewCounterVec</span>(<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">CounterOpts</span>{
	<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;http_api_counter&#34;</span>,
	<span style="color:#a6e22e">Help</span>: <span style="color:#e6db74">&#34;web http requests number&#34;</span>,
}, []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;handler&#34;</span>})

<span style="color:#75715e">// 声明 一组 Counter
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">apiTotalCounter</span> = <span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">NewCounter</span>(<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">CounterOpts</span>{
	<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;http_api_total_counter&#34;</span>,
	<span style="color:#a6e22e">Help</span>: <span style="color:#e6db74">&#34;web http requests number&#34;</span>,
})
<span style="color:#75715e">// 注册到 prometheus exporter 中
</span><span style="color:#75715e"></span><span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiTotalCounter</span>)
<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiCounterVec</span>)

<span style="color:#75715e">// 计数
</span><span style="color:#75715e"></span><span style="color:#a6e22e">apiTotalCounter</span>.<span style="color:#a6e22e">Inc</span>()
<span style="color:#a6e22e">apiCounterVec</span>.<span style="color:#a6e22e">WithLabelValues</span>(<span style="color:#e6db74">&#34;/api&#34;</span>).<span style="color:#a6e22e">Inc</span>()
</code></pre></div><ol start="3">
<li>注册自定义接口 Histogram, 示例如下</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 声明一组 Histogram
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">apiHandleMS</span> = <span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">NewHistogramVec</span>(<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">HistogramOpts</span>{
	<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;http_api_handler_ms&#34;</span>,
	<span style="color:#a6e22e">Help</span>: <span style="color:#e6db74">&#34;Microseconds of HTTP interface processing&#34;</span>,
	<span style="color:#a6e22e">Buckets</span>: <span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">LinearBuckets</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">10</span>),
}, []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;handler&#34;</span>})
<span style="color:#75715e">// 注册到 prometheus exporter 种 
</span><span style="color:#75715e"></span><span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiHandleMS</span>)
<span style="color:#75715e">// 计数
</span><span style="color:#75715e"></span><span style="color:#a6e22e">apiHandleMS</span>.<span style="color:#a6e22e">WithLabelValues</span>(<span style="color:#e6db74">&#34;/api&#34;</span>).<span style="color:#a6e22e">Observe</span>(<span style="color:#a6e22e">xx</span>)
</code></pre></div><ul>
<li><a href="https://github.com/he2121/demos/tree/master/prometheus" target="_blank" rel="noopener">完整示例仓库</a>, 大致流程如下</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">// 初始化 prometheus exporter
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">initPrometheus</span>()

	<span style="color:#75715e">// web 示例
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/api1&#34;</span>, <span style="color:#a6e22e">prometheusMetric</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#a6e22e">api1</span>)))
	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/api2&#34;</span>, <span style="color:#a6e22e">prometheusMetric</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#a6e22e">api2</span>)))
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:1234&#34;</span>, <span style="color:#66d9ef">nil</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		panic(<span style="color:#a6e22e">err</span>)
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">initPrometheus</span>() {
	<span style="color:#75715e">// 注册自定义的监控指标
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiTotalCounter</span>)
	<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiCounterVec</span>)
	<span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">MustRegister</span>(<span style="color:#a6e22e">apiHandleMS</span>)
	<span style="color:#75715e">// 暴露 exporter 地址，prometheus server 通过 pull 这个地址，拉取指标数据
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/metrics&#34;</span>, <span style="color:#a6e22e">promhttp</span>.<span style="color:#a6e22e">Handler</span>())
	<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>() {
		<span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:1235&#34;</span>, <span style="color:#66d9ef">nil</span>)
	}()
}

<span style="color:#75715e">// metric 中间件
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">prometheusMetric</span>(<span style="color:#a6e22e">handler</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
		<span style="color:#75715e">// 总接口访问量计数
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">apiTotalCounter</span>.<span style="color:#a6e22e">Inc</span>()
		<span style="color:#75715e">// 单个接口访问量计数
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">apiCounterVec</span>.<span style="color:#a6e22e">WithLabelValues</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">String</span>()).<span style="color:#a6e22e">Inc</span>()
		<span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
		<span style="color:#a6e22e">handler</span>.<span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
		<span style="color:#a6e22e">ms</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">UnixMicro</span>() <span style="color:#f92672">-</span> <span style="color:#a6e22e">start</span>.<span style="color:#a6e22e">UnixMicro</span>()
		<span style="color:#75715e">// 接口时延计数
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">apiHandleMS</span>.<span style="color:#a6e22e">WithLabelValues</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">String</span>()).<span style="color:#a6e22e">Observe</span>(float64(<span style="color:#a6e22e">ms</span>))
	}
}
</code></pre></div><p>自定义指标结果：</p>
<p><p class="markdown-image">
  <img src="http://ganghuan.oss-cn-shenzhen.aliyuncs.com/img/image-20211209111424017-2021-12-09.png" alt="image-20211209111424017"  />
</p></p>
<h2 id="总结">总结 <a href="#%e6%80%bb%e7%bb%93" class="anchor">🔗</a></h2><ul>
<li>介绍了 Prometheus 四种 Metric 类型</li>
<li>介绍了 PormQL 简单使用</li>
<li>以一个实际例子介绍了如何用 Prometheus 提供的 client SDK 自定义监控</li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="https://he2121.github.io/xiaohe-blog/tags/prometheus">prometheus</a>
            
                <a href="https://he2121.github.io/xiaohe-blog/tags/cloud-native">cloud native</a>
            
                <a href="https://he2121.github.io/xiaohe-blog/tags/%E7%9B%91%E6%8E%A7">监控</a>
            
        </div>
    
    
    

</section>

<script src="https://utteranc.es/client.js"
        repo="he2121/xiaohe-blog"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="https://github.com/he2121/" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28"  viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>Github</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)">
            <g id="Github" transform="translate(264.000000, 939.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M35.9985,13 C22.746,13 12,23.7870921 12,37.096644 C12,47.7406712 18.876,56.7718301 28.4145,59.9584121 C29.6145,60.1797862 30.0525,59.4358488 30.0525,58.7973276 C30.0525,58.2250681 30.0315,56.7100863 30.0195,54.6996482 C23.343,56.1558981 21.9345,51.4693938 21.9345,51.4693938 C20.844,48.6864054 19.2705,47.9454799 19.2705,47.9454799 C17.091,46.4500754 19.4355,46.4801943 19.4355,46.4801943 C21.843,46.6503662 23.1105,48.9634994 23.1105,48.9634994 C25.2525,52.6455377 28.728,51.5823398 30.096,50.9649018 C30.3135,49.4077535 30.9345,48.3460615 31.62,47.7436831 C26.2905,47.1352808 20.688,45.0691228 20.688,35.8361671 C20.688,33.2052792 21.6225,31.0547881 23.1585,29.3696344 C22.911,28.7597262 22.0875,26.3110578 23.3925,22.9934585 C23.3925,22.9934585 25.4085,22.3459017 29.9925,25.4632101 C31.908,24.9285993 33.96,24.6620468 36.0015,24.6515052 C38.04,24.6620468 40.0935,24.9285993 42.0105,25.4632101 C46.5915,22.3459017 48.603,22.9934585 48.603,22.9934585 C49.9125,26.3110578 49.089,28.7597262 48.8415,29.3696344 C50.3805,31.0547881 51.309,33.2052792 51.309,35.8361671 C51.309,45.0917119 45.6975,47.1292571 40.3515,47.7256117 C41.2125,48.4695491 41.9805,49.9393525 41.9805,52.1877301 C41.9805,55.4089489 41.9505,58.0067059 41.9505,58.7973276 C41.9505,59.4418726 42.3825,60.1918338 43.6005,59.9554002 C53.13,56.7627944 60,47.7376593 60,37.096644 C60,23.7870921 49.254,13 35.9985,13" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>


</div>

    

    <div class="copyright">
    
       © Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       小贺
    
    </div>

    
</footer>



  </body>
</html>
